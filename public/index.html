<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>test</title>
</head>
<body>
  <button id="btn">请求</button>
  <button id="zd">中断</button>
  <hr>
  <form action="/api/upfile" method="post" enctype="multipart/form-data">
    <input type="file" name="file"/>
    <button type="submit">上传</button>
  </form>
  <script src="ajax.js"></script>
  <script>
    let xhr
    document.getElementById('btn').addEventListener('click',()=>{
      ajax('/api/post',{
        type:'post',
        params:JSON.stringify({'oo':'bb'}),
        getXhr:x=>{
          xhr=x
        }
      }).then(res=>{
        console.log(res)
      }).catch(err=>{
        console.log(err)
      })
    })

    document.getElementById('zd').addEventListener('click',()=>{
      if(xhr){
        xhr.abort()
      }
    })
  </script>
</body>
</html>